The custom action will be managed by an Elastic Beanstalk worker environment, running as a periodic process.


# Create an S3 bucket to store assets in


# Create an Elastic Beanstalk App via the Console
## New Environment
* Worker Environment
## Environment Type
* Predefined Configuration = Ruby
* Environment type: Load balancing, auto scaling
## Application Version
* Source = Existing application version, "Sample Application"
* Deployment Limits = 30%
## Environment Info
* Environment name = railsassetdist-env
* Description =
## Additional Resources
* None
## Configuration Details
* Instance Type = t2.medium
* EC2 key pair = <whatever you use to log into your machien>
* email address = markmans+ebworker@amazon.com
* health check URL = /health_check
## Environment Tags
* AWS_ACCESS_KEY_ID=<ACCESS ID>
* AWS_SECRET_ACCESS_KEY=<ACCESS KEY>
* FOG_DIRECTORY=markmans-reinvent-demo-assets
* FOG_PROVIDER=AWS
## Worker Details
* Worker queue = Autogenerated queue
* HTTP path = /
* Mime type = application/json
* HTTP connections = 10
* Visibility timeout = 300
## Permissions
* Instance Profile: <create IAM role>
* Service Role: <create the default role>


# Notes

eb init --region us-east-1
--application-name CustomAction 
--environment-name RailsAssetDistCustomActionEnv 
--solution-stack XXX 
--application-name rails-asset-distribution-custom-action-for-aws-code-pipeline

$ aws elasticbeanstalk create-application --application-name "RailsAssetDistributionCustomAction" --description "AWS CodePipeline custom action for distributing Rails assets"
$ aws elasticbeanstalk create-environment \
  --application-name "RailsAssetDistributionCustomAction" \
  --description "" \
  --solution-stack-name "64bit Amazon Linux 2015.03 v2.0.0 running Ruby 2.2 (Passenger Standalone)" \
  --option-settings \
    Namespace=aws:elasticbeanstalk:application:environment,OptionName=AWS_ACCESS_KEY_ID,Value=XX \
	Namespace=aws:elasticbeanstalk:application:environment,OptionName=AWS_SECRET_KEY,Value=XX
